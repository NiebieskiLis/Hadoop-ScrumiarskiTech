1) Nasza tabela

dane_projektu                                | | event_data   
 projekt | event_projektu |  project_manager | |czas | ilosc_osob |

2)Create table in HBase

create 'projekty', 'dane_projektu' , 'event_data' 


3) w HIVE tworzymy tabelÄ™:

CREATE EXTERNAL TABLE hbase_table_2(key string, projekt string, event_projektu string, project_manager int,czas int, ilosc_osob int) 
STORED BY 'org.apache.hadoop.hive.hbase.HBaseStorageHandler'
WITH SERDEPROPERTIES ("hbase.columns.mapping" = ":key,dane_projektu:projekt , dane_projektu:event_projektu, dane_projektu:project_manager,event_data:czas , event_data:ilosc_osob")
TBLPROPERTIES("hbase.table.name" = "projekty");

4)

5)
insert into hbase_table_2 select
      concat(projekt,'-',cast(cast(concat(rok,'-',miesiac,'-',dzien) AS DATE) AS STRING)) key,
      projekt,
      event_projektu,
      project_manager,
      czas,
      ilosc_osob
      from pomocnicza2
 
